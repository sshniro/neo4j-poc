
<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
    <title>graph-results</title>
    <link rel="stylesheet" href="./css/popoto.min.css">
    <link rel="stylesheet" href="./css/vis.min.css">
    <link rel="stylesheet" href="./css/custom.css">
</head>
<body>
<div id="popoto-taxonomy" class="drawer">
    <h5>Node labels</h5>
    <!-- Label/taxonomy filter will be generated here -->
</div>
<div id="main" class="main">
    <div class="notice-bar">
        Mitrai Plus
    </div>
    <div class="search-bar">
        <form id="filter-form">
            <label>
                <input id="constraint" type="text" style="width: 500px;" value="">
            </label>
            <input id="filter-button" type="button" value="Search">
        </form>
    </div>
    <div class="frame" id="popoto-graph">
        <!-- Graph will be generated here-->
    </div>
    <!--<div class="code-bar" id="popoto-cypher">-->
    <!--</div>-->
    <!--<div class="frame" id="vis">-->
        <!--&lt;!&ndash; Results visualization will be generated here &ndash;&gt;-->
    <!--</div>-->
</div>
<!-- Required scripts -->
<script src="./js/jquery-2.1.0.min.js" charset="utf-8"></script>
<script src="./js/d3.v3.min.js" charset="utf-8"></script>
<script src="./src/js/popoto.js" charset="utf-8"></script>
<!--<script src="./js/vis.min.js"></script>-->

<script src="./js/popotoHelper.js"></script>
<script src="js/helper.js" charset="utf-8"></script>
<script src="js/apiAiHelper.js" charset="utf-8"></script>
<script src="js/eventHelper.js" charset="utf-8"></script>

<script>

    var accessToken = "4bd93c3337ca4d199b272cdf3a5ed514";
    var baseUrl = "https://api.api.ai/v1/";

    function UrlExists(url)
    {
        var http = new XMLHttpRequest();
        http.open('HEAD', url, false);
        http.send();
        return http.status!=404;
    }

    // Change ellipses dimension to have circles
    popoto.graph.node.ELLIPSE_RX = 40;
    popoto.graph.node.ELLIPSE_RY = 40;
    popoto.graph.node.TEXT_Y = 51;
//    popoto.graph.node.TE
    popoto.graph.LINK_DISTANCE = 150;
    popoto.graph.node.BACK_CIRCLE_R = 48;

    // Disable toggle taxonomy tool button
    popoto.tools.TOGGLE_TAXONOMY = false;

//    popoto.rest.CYPHER_URL = "http://www.popotojs.com/proxy.php";
    popoto.rest.CYPHER_URL = "http://localhost:7474/db/data/transaction/commit";
    popoto.rest.AUTHORIZATION = "Basic " + btoa("neo4j:aws");

    popoto.graph.node.NODE_MAX_CHARS = 13;

    // Define the list of label provider to customize the graph behavior:

    // Change the number of displayed results:
    popoto.query.RESULTS_PAGE_SIZE = 7;

    popoto.logger.LEVEL = popoto.logger.LogLevels.INFO;

    /**
     * Add a listener on result received to update map.
     */
//    popoto.result.onGraphResultReceived(
//        function (graphResultObject) {
//
//            var nodes = convertNodes(graphResultObject.nodes);
//            var edges = convertEdges(graphResultObject.edges);
//            var container = document.getElementById('vis');
//
//            // provide the data in the vis format
//            var data = {
//                nodes: nodes,
//                edges: edges
//            };
//            var options = {
//                nodes: {
//                    shape: 'circle',
//                    borderWidth: 2,
//                    size: 20,
//                    font: {
//                        size: 10,
//                        color: '#ffffff'
//                    }
//                },
//                edges: {
//                    length: 200,
//                    font: {
//                        align: 'top',
//                        size: 10
//                    },
//                    arrows: 'to'
//                },
//                groups: {
//                    "Person": {
//                        color: {background: '#68BDF6', border: '#5CA8DB'}
//                    },
//                    "Movie": {
//                        color: {background: '#FF756E', border: '#E06760'}
//                    }
//                }
//            };
//
//            // initialize the network
//            var network = new vis.Network(container, data, options);
//        }
//    );

//    function convertNodes(nodes) {
//        var convertedNodes = [];
//
//        nodes.forEach(function (node) {
//            var nodeLabel = node.labels[0];
//            convertedNodes.push({
//                id: node.id,
//                label: (nodeLabel == "Person" ? node.properties["name"] : node.properties["title"]),
//                group: nodeLabel
//            })
//        });
//
//        return convertedNodes;
//    }
//
//    function convertEdges(edges) {
//        var convertedEdges = [];
//
//        edges.forEach(function (edge) {
//            convertedEdges.push({
//                from: edge.startNode,
//                to: edge.endNode,
//                label: edge.type
//            })
//        });
//
//        return convertedEdges;
//    }

    // Start the generation using parameter as root label of the query.
    popoto.start("Mitrai");

</script>
</body>
</html>
